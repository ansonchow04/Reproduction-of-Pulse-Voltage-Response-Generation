下面用**极简 + 白话**帮你概括 Step 1、Step 2、Step 3 **到底干了什么**（对应 README 里的功能）：

---

# ✅ **一句话总结（最短版）**

**Step 1：把原始大 Excel 拆解→只留下每一次工步（charge/ rest/ pulse）的摘要表。**
**Step 2：从工步表里抽取你需要的 U1–Uxx 这些电压特征。**
**Step 3：把所有电池的这些特征整合成一个总表，按 SOC 分类。**

---

# 🧩 **详细但仍然很白话的说明**

---

# **Step 1 – Extract Workstep Sheet（提取工步层）**

### **干什么？**

把每个电池的**原始 Excel**（几十 MB、几十万行记录）处理成一个**小的“工步摘要表”**。

### **为什么要做？**

* 原始数据太大：100 Hz 采样 + 数小时实验 = 上百万行
* 分析真正需要的是每个“工步”的开始和结束信息
  例如：

  * 5% SOC, 30ms, 0.5C 正脉冲
  * 随后的静置
  * 再来一个 0.5C 负脉冲
    …

### **结果是什么？**

你会得到一个类似这样的表（几百 KB）：
每行 = 一个工步（pulse / rest / charge / discharge）
包含：工步类型、起止时间、统计的电压、电流等。

---

# **Step 2 – Feature Extraction（提取特征）**

### **干什么？**

从 Step1 生成的“工步表”中抽取你想要的**特征电压点 U1 – Uxx**。

举例：

* U1：静置后的 OCV
* U2：0.5C 正脉冲开始电压
* U3：0.5C 正脉冲结束电压
* …
* U10–U17：1C 正/负脉冲 + 静置
* U18–U25：1.5C 的
* …共 41 个可能点

Step 2 就是把这些点，一个一个从工步表里面抓出来。

### **输出内容？**

对每个电池，会生成一个小文件（约 7KB）：

每行 = 一个 SOC（例如 5%、10%、…、50%）
每列 = U1, U2, …, Uxx 的特征电压

---

# **Step 3 – Feature Collection（整合特征表）**

### **干什么？**

把所有电池的 Step2 输出合并成一个大表，分 SOC 整理。

你会得到：

* 一个 LMO_10Ah_W_5000.xlsx
* 一个 NMC_21Ah_W_3000.xlsx
* 一个 LFP_35Ah_W_5000.xlsx
  …

每个文件里包含：

* Sheet **SOC ALL**：所有 SOC 的全部样本
* Sheet **SOC5**：只放 5% SOC 的所有电池数据
* Sheet **SOC10**：只放 10% SOC 的所有电池数据
* …

### **目的？**

方便你直接把数据丢进机器学习模型，不需要自己再拼数据。

---

# 📌 **最终理解（超清晰版）**

| Step       | 输入             | 输出                | 核心作用          |
| ---------- | -------------- | ----------------- | ------------- |
| **Step 1** | 原始百万行记录        | 工步层摘要表            | 把复杂原始数据结构化    |
| **Step 2** | 工步层            | 各 SOC 的 U1-Uxx 特征 | 提取特征点（机器学习可用） |
| **Step 3** | 所有电池的 Step2 输出 | 整合大表              | 方便建模与分析       |

---
